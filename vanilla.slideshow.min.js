/**
 * Vanilla Slideshow ;) (https://github.com/xylphid)
 * Version 0.1.2
 *
 * @author Anthony PERIQUET
 */
!function(s){var e=null,i={time:null,timeout:!1};s.slideshow=function(n,o){return this instanceof s.slideshow?(this.options=t(s.slideshow.defaults,o),this.autostart=this.options.autostart,this.opened=!1,this.slides=[],void("undefined"!=typeof n&&(this.elm=s(n),e=this,s(window).on("resize",function(){e.opened&&(i.time=new Date,i.timeout===!1&&(i.timeout=!0,setTimeout(s.slideshow.resize,200)))}),this.elm.attr("data-single")||s(document).on("click",n,function(e){return e.preventDefault(),s.slideshow.open(e.value)}),s(document).on("keydown",function(i){e&&e.opened&&(27==i.which&&s.slideshow.close(),e.elm.attr("data-single")||37!=i.which||s.slideshow.prev(),e.elm.attr("data-single")||39!=i.which||s.slideshow.next())})))):new s.slideshow(n,o)},s.slideshow.prototype={constructor:s.slideshow,open:function(e){return e instanceof s&&(this.elm=e),this.setOverlay(),this.setModal(),this.showSpinner(),this.show(),this.opened=!0,!1},setOverlay:function(){s(".overlay").remove(),this.overlay=s("<div>").addClass("overlay").css("background",this.options.overlay).css("bottom",0).css("display","none").css("height","100%").css("left",0).css("opacity",this.options.opacity).css("position","fixed").css("right",0).css("top",0).css("width","100%").css("z-index",this.options.zIndex).appendTo("body").fadeIn()},setModal:function(){s(".vanilla-slideshow").remove(),this.modal=s("<div>").addClass("vanilla-slideshow").append(s("<div>").addClass("vanilla-slider")).append(this.getActions()).appendTo("body").swipe("left",function(){s.slideshow.next()}).swipe("right",function(){s.slideshow.prev()}),this.center()},getActions:function(){return actions=s("<div>").addClass("actions").append(s("<a>").addClass("fullscreen").on("click",function(){s.slideshow.fullscreen()})).append(s("<a>").addClass("close").on("click",this.close)),this.elm.attr("data-single")||actions.prepend(s("<a>").addClass("play").on("click",function(){s.slideshow.play()})).prepend(s("<a>").addClass("next").on("click",function(){s.slideshow.next()})).prepend(s("<a>").addClass("prev").on("click",function(){s.slideshow.prev()})),actions},show:function(i){this.showSpinner();var t=s("<img>").attr("src",this.elm.attr("href")).addClass("slide").addClass(this.options.scaling).attr("alt","Vanilla Slideshow").load(function(){s(this).prependTo(".vanilla-slideshow > .vanilla-slider"),e.centerSlide(),s.slideshow.hideSpinner(),i&&e.slideOut(i),s.slideshow.isPlaying()&&s.slideshow.setPlayer(setTimeout(s.slideshow.next,e.options.slideDelay))});this.slides.push(t)},centerSlide:function(){var s=this.slides.slice(-1)[0];if("fill"==this.options.scaling){scalingH=this.modal.outerHeight()/s.nodes[0].naturalHeight,scalingW=this.modal.outerWidth()/s.nodes[0].naturalWidth;var e=scalingH>scalingW?scalingH:scalingW,i=(this.modal.outerHeight()-s.nodes[0].naturalHeight*e)/2;s.css("transform-origin","0px 0px 0px").css("transform","translate3d(0px, "+i+"px, 0px) scale("+e+")")}},center:function(){this.modal.css("left","50%").css("margin-left",-(this.modal.outerWidth()/2)+"px").css("margin-top",-(this.modal.outerHeight()/2)+"px").css("position","fixed").css("top","50%").css("z-index",this.options.zIndex+1)},resize:function(){new Date-i.time<200?setTimeout(s.slideshow.resize,200):(i.timeout=!1,this.center(),this.centerSlide())},showSpinner:function(){this.working=!0,this.options.showSpinner&&(this.spinner=this.spinner||s("<div>").addClass("spinner"),this.modal.prepend(this.spinner))},hideSpinner:function(){this.spinner&&this.spinner.remove(),this.working=!1},close:function(){e.modal.fadeOut(100),e.overlay.fadeOut().css("z-index",-1),this.opened=!1},slideOut:function(e){var i=this.slides.shift();i.on("transitionend",function(){s(this).remove()}),i.addClass("left"==e?"removeToLeft":"removeToRight")},next:function(){this.options.single||(next=this.elm.next(),next||(next=this.elm.parent().firstChild()),this.elm=next,this.show("left"))},prev:function(){this.options.single||(previous=this.elm.prev(),previous||(previous=this.elm.parent().lastChild()),this.elm=previous,this.show("right"))},play:function(){this.options.autostart=!this.options.autostart,this.options.autostart?this.setPlayer(setTimeout(s.slideshow.next,e.options.slideDelay)):clearTimeout(this.player)},isPlaying:function(){return this.options.autostart},setPlayer:function(s){this.player=s},fullscreen:function(){this.isPlaying()&&(this.options.autostart=!this.options.autostart,clearTimeout(this.player)),window.open(this.elm.attr("href"))}},s.slideshow.defaults={autostart:!1,opacity:.75,overlay:"#000",scaling:"fitmax",showSpinner:!0,slideDelay:5e3,zIndex:1},s.slideshow.dispatcher=function(s,i){return e&&"function"==typeof e[i]?(/Event/.test(s)&&s.preventDefault(),e[i](s),e):void 0},s.slideshow.open=function(e){return s.slideshow.dispatcher(e,"open")},s.slideshow.close=function(e){return s.slideshow.dispatcher(e,"close")},s.slideshow.hideSpinner=function(e){return s.slideshow.dispatcher(e,"hideSpinner")},s.slideshow.next=function(e){return s.slideshow.dispatcher(e,"next")},s.slideshow.prev=function(e){return s.slideshow.dispatcher(e,"prev")},s.slideshow.play=function(e){return s.slideshow.dispatcher(e,"play")},s.slideshow.isPlaying=function(){return e?e.isPlaying():void 0},s.slideshow.setPlayer=function(s){e&&e.setPlayer(s)},s.slideshow.fullscreen=function(e){return s.slideshow.dispatcher(e,"fullscreen")},s.slideshow.resize=function(e){s.slideshow.dispatcher(e,"resize")};var t=function(s,e){s="undefined"!=typeof s?s:{};for(var i in e)e[i]&&e[i].constructor&&e[i].constructor===Object?(s[i]=s[i]||{},arguments.callee(s[i],e[i])):s[i]=e[i];return s};s.prototype.slideshow=function(i){return this instanceof s&&(this.attr("data-single","true"),e=new s.slideshow(this,i),s.slideshow.open()),this},s(document).on("click","a[data-slideshow]",function(e){e.preventDefault(),s(e.value).slideshow()})}(vanilla);